{"ast":null,"code":"import { TemplateRef } from '@angular/core';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/network/dataServices/order.service\";\nimport * as i2 from \"@ng-bootstrap/ng-bootstrap\";\nimport * as i3 from \"@angular/common\";\nconst _c0 = [\"content\"];\n\nfunction OrderHistoryComponent_ng_template_0_tr_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵpipe(7, \"currency\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"td\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"td\");\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"td\");\n    i0.ɵɵtext(13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"td\");\n    i0.ɵɵtext(15);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const item_r5 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(item_r5.chefMenu.item_name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(item_r5.chefMenu.cuisineCategory.cuisine_name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(7, 7, item_r5.chefMenu.menu_item_price, \"USD\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(item_r5.quantity);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(item_r5.chefMenu.chef.chef_fname + \" \" + item_r5.chefMenu.chef.chef_lname);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(item_r5.chefMenu.week);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(item_r5.chefMenu.menucategories);\n  }\n}\n\nfunction OrderHistoryComponent_ng_template_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 8)(1, \"h4\", 9);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"button\", 10);\n    i0.ɵɵlistener(\"click\", function OrderHistoryComponent_ng_template_0_Template_button_click_3_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r7);\n      const modal_r3 = restoredCtx.$implicit;\n      return modal_r3.dismiss(\"Cross click\");\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"div\", 11)(5, \"table\", 5)(6, \"thead\")(7, \"tr\")(8, \"th\", 6);\n    i0.ɵɵtext(9, \"Name\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"th\", 6);\n    i0.ɵɵtext(11, \"Cusisine\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"th\", 6);\n    i0.ɵɵtext(13, \"Price\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"th\", 6);\n    i0.ɵɵtext(15, \"Quantity\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"th\", 6);\n    i0.ɵɵtext(17, \"Chef\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(18, \"th\", 6);\n    i0.ɵɵtext(19, \"Day\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(20, \"th\", 6);\n    i0.ɵɵtext(21, \"Category\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(22, \"tbody\");\n    i0.ɵɵtemplate(23, OrderHistoryComponent_ng_template_0_tr_23_Template, 16, 10, \"tr\", 7);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(24, \"div\", 12)(25, \"button\", 13);\n    i0.ɵɵlistener(\"click\", function OrderHistoryComponent_ng_template_0_Template_button_click_25_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r7);\n      const modal_r3 = restoredCtx.$implicit;\n      return modal_r3.close(\"Close click\");\n    });\n    i0.ɵɵtext(26, \"Close\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Order Summary: \", ctx_r1.viewOrder.orderid, \"\");\n    i0.ɵɵadvance(21);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.viewOrder.orderItems);\n  }\n}\n\nfunction OrderHistoryComponent_tr_29_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"td\");\n    i0.ɵɵtext(7);\n    i0.ɵɵpipe(8, \"currency\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\", 14)(10, \"button\", 15);\n    i0.ɵɵlistener(\"click\", function OrderHistoryComponent_tr_29_Template_button_click_10_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r11);\n      const order_r9 = restoredCtx.$implicit;\n      const ctx_r10 = i0.ɵɵnextContext();\n      return ctx_r10.showMenuModal(order_r9);\n    });\n    i0.ɵɵtext(11, \"View\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(12, \"td\", 14)(13, \"button\", 15);\n    i0.ɵɵlistener(\"click\", function OrderHistoryComponent_tr_29_Template_button_click_13_listener() {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r12 = i0.ɵɵnextContext();\n      return ctx_r12.cancelOrder();\n    });\n    i0.ɵɵtext(14, \"Request Cancel\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(15, \"td\")(16, \"ngb-rating\", 16);\n    i0.ɵɵlistener(\"rateChange\", function OrderHistoryComponent_tr_29_Template_ngb_rating_rateChange_16_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r11);\n      const order_r9 = restoredCtx.$implicit;\n      const ctx_r13 = i0.ɵɵnextContext();\n      return ctx_r13.rating[order_r9.orderid] = $event;\n    })(\"rateChange\", function OrderHistoryComponent_tr_29_Template_ngb_rating_rateChange_16_listener() {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r14 = i0.ɵɵnextContext();\n      return ctx_r14.postRating();\n    })(\"hover\", function OrderHistoryComponent_tr_29_Template_ngb_rating_hover_16_listener($event) {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r15 = i0.ɵɵnextContext();\n      return ctx_r15.hovered = $event;\n    })(\"leave\", function OrderHistoryComponent_tr_29_Template_ngb_rating_leave_16_listener() {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r16 = i0.ɵɵnextContext();\n      return ctx_r16.hovered = 0;\n    });\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const order_r9 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(order_r9.orderid);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(5, 5, order_r9.order_date, \"medium\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(8, 8, order_r9.order_amount, \"USD\"));\n    i0.ɵɵadvance(9);\n    i0.ɵɵproperty(\"max\", 5)(\"rate\", ctx_r2.rating[order_r9.orderid]);\n  }\n}\n\nexport let OrderHistoryComponent = /*#__PURE__*/(() => {\n  class OrderHistoryComponent {\n    constructor(orderService, modalService) {\n      this.orderService = orderService;\n      this.modalService = modalService;\n      this.orders = [];\n      this.selected = 0;\n      this.hovered = 0;\n      this.oid = 0;\n      this.rating = {};\n      this.origRating = {};\n    }\n\n    ngOnInit() {\n      this.orderService.getOrdersByCustomerId().subscribe(data => {\n        this.orders = data;\n        this.rating = this.orders.reduce((acc, order) => {\n          return Object.assign(Object.assign({}, acc), {\n            [Number(order.orderid)]: order.rating\n          });\n        }, {});\n        this.origRating = this.orders.reduce((acc, order) => {\n          return Object.assign(Object.assign({}, acc), {\n            [Number(order.orderid)]: order.rating\n          });\n        }, {});\n      });\n    }\n\n    showMenuModal(menu) {\n      this.viewOrder = menu;\n      this.modalService.open(this.content, {\n        centered: true,\n        size: 'lg'\n      });\n    }\n\n    setRating($event, id) {\n      console.log({\n        id,\n        $event\n      });\n    }\n\n    getRating() {\n      console.log(this.rating);\n      return 0;\n    }\n\n    postRating() {\n      Object.entries(this.rating).forEach(([orderid, ratings]) => {\n        console.log({\n          orderid,\n          ratings\n        });\n\n        if (this.rating[Number(orderid)] != this.origRating[Number(orderid)]) {\n          this.orderService.postOrderRating({\n            orderid,\n            ratings\n          }).subscribe();\n        }\n      });\n    }\n\n    cancelOrder() {\n      alert('Please read the cancellation policy and reach out to the customer support @313-3357573 for order cancellation or send an email to the chef');\n    }\n\n  }\n\n  OrderHistoryComponent.ɵfac = function OrderHistoryComponent_Factory(t) {\n    return new (t || OrderHistoryComponent)(i0.ɵɵdirectiveInject(i1.OrderService), i0.ɵɵdirectiveInject(i2.NgbModal));\n  };\n\n  OrderHistoryComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: OrderHistoryComponent,\n    selectors: [[\"app-order-history\"]],\n    viewQuery: function OrderHistoryComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5, TemplateRef);\n      }\n\n      if (rf & 2) {\n        let _t;\n\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.content = _t.first);\n      }\n    },\n    decls: 30,\n    vars: 1,\n    consts: [[\"content\", \"\"], [1, \"header\"], [1, \"box1\"], [2, \"text-align\", \"center\"], [2, \"margin-left\", \"140px\"], [1, \"table\", \"table-striped\"], [\"scope\", \"col\"], [4, \"ngFor\", \"ngForOf\"], [1, \"modal-header\"], [1, \"modal-title\"], [\"type\", \"button\", \"aria-label\", \"Close\", 1, \"btn-close\", 3, \"click\"], [1, \"modal-body\"], [1, \"modal-footer\"], [\"type\", \"button\", 1, \"btn\", \"btn-light\", 3, \"click\"], [1, \"order-btn\"], [1, \"btn\", \"view-order\", 3, \"click\"], [3, \"max\", \"rate\", \"rateChange\", \"hover\", \"leave\"]],\n    template: function OrderHistoryComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, OrderHistoryComponent_ng_template_0_Template, 27, 2, \"ng-template\", null, 0, i0.ɵɵtemplateRefExtractor);\n        i0.ɵɵelement(2, \"div\", 1)(3, \"br\");\n        i0.ɵɵelementStart(4, \"div\", 2)(5, \"h1\", 3);\n        i0.ɵɵtext(6, \"Your Order History\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(7, \"br\");\n        i0.ɵɵelementStart(8, \"span\", 4)(9, \"b\");\n        i0.ɵɵtext(10, \"View your orders placed \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(11, \"br\")(12, \"br\");\n        i0.ɵɵelementStart(13, \"table\", 5)(14, \"thead\")(15, \"tr\")(16, \"th\", 6);\n        i0.ɵɵtext(17, \"Order Id\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"th\", 6);\n        i0.ɵɵtext(19, \"Date\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(20, \"th\", 6);\n        i0.ɵɵtext(21, \"Price\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(22, \"th\", 6);\n        i0.ɵɵtext(23, \"view order\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(24, \"th\", 6);\n        i0.ɵɵtext(25, \"Cancel\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(26, \"th\", 6);\n        i0.ɵɵtext(27, \"Rate order\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(28, \"tbody\");\n        i0.ɵɵtemplate(29, OrderHistoryComponent_tr_29_Template, 17, 11, \"tr\", 7);\n        i0.ɵɵelementEnd()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(29);\n        i0.ɵɵproperty(\"ngForOf\", ctx.orders);\n      }\n    },\n    directives: [i3.NgForOf, i2.NgbRating],\n    pipes: [i3.CurrencyPipe, i3.DatePipe],\n    styles: [\"button[_ngcontent-%COMP%]{text-align:center;text-decoration:none;margin:10px;padding-right:20px;background-color:#ffc828;height:30px;border-radius:10%;font-size:14px}select[_ngcontent-%COMP%]{margin-bottom:10px;margin-top:10px;margin-left:0;border:rgb(260,200,40,.6) solid}span[_ngcontent-%COMP%]{margin:0 0 0 50px;font-size:large}table[_ngcontent-%COMP%]{margin:0 auto;border-radius:2%;width:1200px;height:100px;border:rgb(260,200,40);background-color:orange}th[_ngcontent-%COMP%]{background-color:#ffc828}td[_ngcontent-%COMP%]{background-color:#fdf5e6;vertical-align:middle!important}a[_ngcontent-%COMP%]{text-decoration:none;display:inline-block;padding:8px 16px}table[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background-color:#ddd;color:#000;border-radius:50%}.box2[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}\"]\n  });\n  return OrderHistoryComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}